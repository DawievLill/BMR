#!/bin/bash
#
# Check if R is built with system Lapack,
# based on code written by Dirk Eddelbuettel
# for RcppArmadillo
#
# Copyright 2013 - 2015  Dirk Eddelbuettel
#
# Licensed under GPL 2 or later

if [ "${R_HOME}" == "" ]; then
   R_HOME=$(R RHOME)
fi

echo -n "* checking LAPACK_LIBS: "

## external LAPACK has the required function
lapack=$(${R_HOME}/bin/R CMD config LAPACK_LIBS)
hasRlapack=$(echo ${lapack} | grep lRlapack)

if [ "${hasRlapack}" == "" ]; then
    ## We are using a full Lapack
    echo "system LAPACK found"
else
    ## We are using a R's subset of Lapack
    echo "R-supplied partial LAPACK found"
    echo "* gensys solver is not available"
    sed -i '' 's/\/\/#define PREDEF_RLAPACK/\#define PREDEF_RLAPACK/' \
        src/dsgec.cpp
fi


